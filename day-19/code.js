let input1 = `
.....|..........
.....|..+--+....
.....A..|..C....
.F---|----E|--+.
.....|..|..|..D.
.....+B-+..+--+.
`

let input2 = `
.......................................................|.................................................................................................................................................
.+---+.......+-+.+-------------------------------------|-------------------------------------------------------------+.....+-------------------------------------------------------------------+.........
.|...|.......|.|.|.....................................|.............................................................|.....|...................................................................|.........
.|.+-|-------|-------------------------------------------------------------------------------------------------------|---------------+.............+-------------------------+.....+-+.......+-+.........
.|.|.|.......|.|.|.....................................|.............................................................|.....|.........|.............|.........................|.....|.|.......|...........
.|.|.|.+-----|-|-+.+---+.+-------------------------------------+.......+-----------------------+.......+-------------------|---------+...........+-|---+.........+-+.....+---------+.|.......|...+---+...
.|.|.|.|.....|.|...|...|.|.............................|.......|.......|.......................|.......|.............|.....|.....................|.|...|.........|.|.....|...|.......|.......|...|...|...
.|.|.|.|.....|.|...|...|.|.............+---------------|---------------+.+---------------------|---------------------|---------+.....+-----------|-|-+.|.........|.|...+-+...|.....+-|-------|-------+...
.|.|.|.|.....|.|...|...|.|.............|...............|.......|.........|.....................|.......|.............|.....|...|.....|...........|.|.|.|.........|.|...|.....|.....|.|.......|...|.......
.|.|.|.|.....|.|.+-------|-------------|---------------|-------|-+.+-----+.+-------------------|---------------------------|---------|---------------|-|---------|-----------------|-|-------+...|.......
.|.|.|.|.....|.|.|.|...|.|.............|...............|.......|.|.|.......|...................|.......|.............|.....|...|.....|...........|.|.|.|.........|.|...|.....|.....|.|...........|.......
.|.|.+-|-------|---|-+.|.|.+-----------|-----------------------------------|---------------------------+.............|.....|...|.....|...........|.|.|.|.........|.|...|.....|.....|.|...........|.......
.|.|...|.....|.|.|.|.|.|.|.|...........|...............|.......|.|.|.......|...................|.....................|.....|...|.....|...........|.|.|.|.........|.|...|.....|.....|.|...........|.......
.|.|.+-|-------|-------|-|-|---------+.|...............|...+---|-|---------------------------------------------------|---------|-----------------|-----|---------|-|---------|---------------------+.....
.|.|.|.|.....|.|.|.|.|.|.|.|.........|.|...............|...|...|.|.|.......|...................|.....................|.....|...|.....|...........|.|.|.|.........|.|...|.....|.....|.|...........|.|.....
.|.|.|.|...+-|-----|-|---------------------------------|---------|---------------+.+---+.......|.........+-----------|-----|---------|---+.......|.|.|.|.........|.|...|.....|.....|.|...........|.|.....
.|.|.|.|...|.|.|.|.|.|.|.|.|.........|.|...............|...|...|.|.|.......|.....|.|...|.......|.........|...........|.....|...|.....|...|.......|.|.|.|.........|.|...|.....|.....|.|...........|.|.....
.|.|.|.|...|.|.|.|.|.|.+-|-|-------------------------------|---+.|.|.....+-------|-----|-----------------------------|-----|---|-----|---+.......|.|.|.|.........|.|...|.....|.....|.|...........|.|.....
.|.|.|.|...|.|.|.|.|.|...|.|.........|.|...............|...|.....|.|.....|.|.....|.|...|.......|.........|...........|.....|...|.....|...........|.|.|.|.........|.|...|.....|.....|.|...........|.|.....
.|.|.|.|...|.|.|.|.|.|...|.|.........|.|...............|...|.....|.+-------|-----------------------------|---------------------------|---------------------------|-----------|---------------------|-+...
.|.|.|.|...|.|.|.|.|.|...|.|.........|.|...............|...|.....|.......|.|.....|.|...|.......|.........|...........|.....|...|.....|...........|.|.|.|.........|.|...|.....|.....|.|...........|.|.|...
.|.|.|.|...|.|.|.|.|.|...|.|.........|.+---------------|---|-+...|.....+---|---+.|.|...+-------|-----+...+-----------|---------------+...........|.|.+-----------|-|---|---------------------------|-+...
.|.|.|.|...|.|.|.|.|.|...|.|.........|.................|...|.|...|.....|.|.|...|.|.|...........|.....|...............|.....|...|.................|.|...|.........|.|...|.....|.....|.|...........|.|.....
.|.|.|.|...|.|.|.|.|.|...|.|.........|.................|...+-|-------------------|-|---------------------+...........|.....|...|.................+-----|---+.....|.|...|.....|.....+-----------+.|.|.....
.|.|.|.|...|.|.|.|.|.|...|.|.........|.................|.....|...|.....|.|.|...|.|.|...........|.....|...|...........|.....|...|...................|...|...|.....|.|...|.....|.......|.........|.|.|.....
.|.|.|.|...|.|.|.|.+-|-------------+.|.........+---------+...|...+-------|-----|-|-|-----------|-----|---|---------------------|---------------------+.|...+-----|-|---------------------------|-|-|---+.
.|.|.|.|...|.|.|.|...|...|.|.......|.|.........|.......|.|...|.........|.|.|...|.|.|...........|.....|...|...........|.....|...|...................|.|.|.........|.|...|.....|.......|.........|.|.|...|.
.|.|.|.|...|.|.|.|...|...|.|.......|.|.........+-----+.|.+---------------|-------|---+.........|.....|...|...........|.....|...|...................|.|.|.........|.|...+-+...|.......|.........|.|.+---+.
.|.|.|.|...|.|.|.|...|...|.|.......|.|...............|.|.....|.........|.|.|...|.|.|.|.........|.....|...|...........|.....|...|...................|.|.|.........|.|.....|...|.......|.........|.|.......
.|.|.|.+-----|-|-|-----------------|-|---------------|-|-----|---------|-|-|-----+.|.|.........|.....|...|.+---------------|---|-------------------|-|-----------+.|.....|...|.......|.........|.|.......
.|.|.|.....|.|.|.|...|...|.|.......|.|...............|.|.....|.........|.|.|...|...|.|.........|.....|...|.|.........|.....|...|...................|.|.|...........|.....|...|.......|.........|.|.......
.|.|.|.....|.|.|.|.+-------|-------|-------------------------------------|-|---|---|---------+.|.....|...|.|.........|.....|...|...................+-------------------+.|...|.......+---+.+---|-|-+.....
.|.|.|.....|.|.|.|.|.|...|.|.......|.|...............|.|.....|.........|.|.|...|...|.|.......|.|.....|...|.|.........|.....|...|.....................|.|...........|...|.|...|...........|.|...|.|.|.....
.|.|.|.....|.|.|.|.|.|...|.|.......|.|.........+-------|-----|---------|---|---|-----|-------+.|.....+---------------------|---+.....................|.|...........|...|.|...|...........|.|...|.|.|.....
.|.|.|.....|.|.|.|.|.|...|.|.......|.|.........|.....|.|.....|.........|.|.|...|...|.|.........|.........|.|.........|.....|.........................|.|...........|...|.|...|...........|.|...|.|.|.....
.|.|.|.....|.|.|.|.|.|...|.|.......|.|.........|.....|.|.....|.........|.|.|...|...|.|.........|.........|.|.........|.....|.........................|.|.......+---+...|.|...|...+---------------+.|.....
.|.|.|.....|.|.|.|.|.|...|.|.......|.|.........|.....|.|.....|.........|.|.|...|...|.|.........|.........|.|.........|.....|.........................|.|.......|.......|.|...|...|.......|.|...|...|.....
.|.|.|.....|.|.|.|.|.|...|.|.......|.|.........|...+-|-|-------------------|---------|---------|-+.......|.|.........|.....|.........................|.|.......|...+-----|-------+.......|.|...|...|.+-+.
.|.|.|.....|.|.|.|.|.|...|.|.......|.|.........|...|.|.|.....|.........|.|.|...|...|.|.........|.|.......|.|.........|.....|.........................|.|.......|...|...|.|...|...........|.|...|...|.|.|.
.+-|-------|-------|-|---------------|---------|---|-------------------------------|-----------|---------------------------|-----------------------+.|.|.......|...|...|.|...|...........|.|...|...|.|.|.
...|.|.....|.|.|.|.|.|...|.|.......|.|.........|...|.|.|.....|.........|.|.|...|...|.|.........|.|.......|.|.........|.....|.......................|.|.|.......|...|...|.|...|...........|.|...|...|.|.|.
...|.|.....|.|.|.|.|.|...|.|.......|.|.........|.+-------+...|...+-----|-------|-----|---------|---------|-|---------------------------------------|-|---------+...|...|.|...|...........|.|...|...|.|.|.
...|.|.....|.|.|.|.|.|...|.|.......|.|.........|.|.|.|.|.|...|...|.....|.|.|...|...|.|.........|.|.......|.|.........|.....|.......................|.|.|...........|...|.|...|...........|.|...|...|.|.|.
...|.|.....|.|.|.|.|.|...|.|.......+-|---------|---|-|---|---|---+...+---|-----|---|---------------------------------|-------------------------------+.|...........|...|.|...|...........|.|...|...|.|.|.
...|.|.....|.|.|.|.|.|...|.|.........|.........|.|.|.|.|.|...|.......|.|.|.|...|...|.|.........|.|.......|.|.........|.....|.......................|...|...........|...|.|...|...........|.|...|...|.|.|.
...|.|.....|.|.|.|.|.|...|.+-+.......|...+-----------|---|---|-----------------------------------|---------|---------|-----------------------------|---------------|-----|---------+.+---|-------+.|.|.|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.....|.|.|.|.|.|...|.......|.|.|.|...|...|.|.........|.|.......|.|.........|.....|.......................|...|...........|...|.|...|.....|.|...|.|...|.|.|.|.|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.+---|---------|---|-------|-|-|-|-------|-|---+.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|.....|.|...|.|...|.|.+-+.|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|...|.|.|.|.|.|...|.......|.|.|.|...|...|.|...|.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|.....|.|...|.|...|.|.....|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|...|.|.|.|.|.|...|.......|.|.|.|...|...|.|...|.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|.....|.|...|.|...|.|.....|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|...|.|.|.|.|.|...|.......|.|.|.|...|...|.|...|.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|.....|.|...|.|...|.|.....|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|...+-|-|-|-|-|----G------|---|-------+.+-------------|-------|---------------------------------------------------------|-----|-------+.|.|...|.|...|.|.....|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|.....|.|.|.|.|...|.......|.|.|.|...|.|...|...|.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|...|.|.|...|.|...|.|.....|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|.....|.+-|-----------------|-|-|---+.|.+-----------|---------|-|---------|-----|---------------------------|-----------------|-----------------|-----|-+...|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|.....|...|.|.|...|.......|.|.|.|.....|.|.|...|.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|...|.|.|...|.|...|.|.|...|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|.....|...|.|.+-----------|---+.|.....|.|.|...|.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|...|.|.|...|.|...|.|.|...|.
...|.|.....|.|.|.|.|.|...|...|.......|...|.|.....|...|.|.....|.......|.|...|.....|.|.|...|.....|.|.......|.|.........|.....|.......................|...|...........|...|.|...|...|.|.|...|.|...|.|.|...|.
...|.|.....|.|.|.|.+-|---+...|.......|...|.|.....|...|.|.+---|-+.+---------|---------|-+.|.....|.|.......+-----------|-------+.....................|...|.......+---|---|-------+.+-------|-----|---|-+.|.
...|.|.....|.|.|.|...|.......|.......|...|.|.....|...|.|.|...|.|.|...|.|...|.....|.|.|.|.|.....|.|.........|.........|.....|.|.....................|...|.......|...|...|.|...|.|...|.|...|.|...|.|.|.|.|.
...|.|.....|.|.|.|...|.......|.......|...|.|.....|.+---|-----|-|-------|-----------------------+.|.........|.........|.....|.|.....................|...|.......|...|...|.|...|.|...|.|...|.|...|.|.|.|.|.
...|.|.....|.|.|.|...|.......|.......|...|.|.....|.|.|.|.|...|.|.|...|.|...|.....|.|.|.|.|.......|.........|.........|.....|.|.....................|...|.......|...|...|.|...|.|...|.|...|.|...|.|.|.|.|.
...|.|.+---|-|-|-----|-------|-------|---|-----------|---|---|---|---|-------------|-|---|-----------------|---------|-------------------------------------------------|-------|---|-+...|.|...|.|.|.|.|.
...|.|.|...|.|.|.|...|.......|.......|...|.|.....|.|.|.|.|...|.|.|...|.|...|.....|.|.|.|.|.......|.........|.........|.....|.|.....................|...|.......|...|...|.|...|.|...|.....|.|...|.|.|.|.|.
...|.|.|...|.|.|.|...|.......|.......|...|.+-------|-|-+.|...|.|.|...|.|...|.....|.|.|.|.|.......+-------------------|-----|--O------------------------|-------|---|-----|---|-----|-----+.|...|.|.|.|.|.
...|.|.|...|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|.................|.........|.....|.|.....................|...|.......|...|...|.|...|.|...|.......|...|.|.|.|.|.
...|.+-+...|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|...............+-|---------|-----|-------+...............|...|.......|...|...|.|...|.|.+-------+.|.Y.|.|.|.|.|.
...|.......|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|...............|.|.........|.....|.|.....|...............|...|.......|...|...|.|...|.|.|.|.....|.|.|.|.|.|.|.|.
...|.......|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|...............|.|.........|.....|.|.....|...............|...|.......|...|...|.|...|.|.|.|.....|.|.|.|.|.|.|.|.
...|.......|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|...............|.|.........|.....|.|.....|...............|...|.......|...|...|.|...|.|.|.|.....|.|.|.|.|.|.|.|.
...|...+---|-|-|-|-----------|-------|-------------|---------|---|-----|---|-----|-|---|-----------------|-|-----------------|---------------------|-----------|-------|-|---|--N--|-+...|.|.|.|.|.|.|.|.
...|...|...|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|...............|.|.........|.....|.|.....|...............|...|.......|...|...|.|...|.|.|.|.|...|.|.|.|.|.|.|.|.
...|...|...|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|...............|.|.........|.....|.|.....|...............|...|.......|...|...|.|...|.|.|.|.|...|.|.|.+-+.|.|.|.
...|...|...|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|...............|.|.........|.....|.|.....|...............|...|.......|...|...|.|...|.|.|.|.|...|.|.|.....|.|.|.
...|.+-----|-|-------|---------------------------|-------|-----|-|---|-|---------------|-|-----+.........|.|.........|.....|.|.....|...............|...|.......|...|...|.|...+-|-|-|---+.|.|.|.....|.|.|.
...|.|.|...|.|.|.|...|.......|.......|...|.......|.|.|...|...|.|.|...|.|...|.....|.|.|.|.|.....|.........|.|.........|.....|.|.....|...............|...|.......|...|...|.|.....|.|.|.|.|.|.|.|.....|.|.|.
...|.|.|.+-|-|-----------------------------------|-|-+...|...|.|.|...|.|...|.....|.|.|.|.|.....|.........|.|.........|.....|.|.....|...............|...|.......|...|...|.|.....|.|.|.|.|.|.|.|.....|.|.|.
...|.|.|.|.|.|.|.|...|.......W.......|...|.......|.|.....|...|.|.|...|.|...|.....|.|.|.|.|.....|.........|.|.........|.....|.|.....|...............|...|.......|...|...|.|.....|.|.|.|.|.|.|.|.....|.|.|.
...|.|.|.|.|.|.|.|...|.......|.......|...|.......|.|.....|...|.|.|...|.|...|.....|.|.|.|.|.....|.........|.|.........|.....|.|.....|...............|...|.......|...|...|.|.....|.|.|.|.|.|.|.|.....|.|.|.
...|.|.|.|.|.|.|.|...|.......|.......|...|.......|.|.....|...|.|.|...|.|...|.....|.|.|.|.|.....|.........|.|.........|.....|.|.....|...............|...|.......|...|...|.|.....|.|.|.|.|.|.|.|.....|.|.|.
...|.|.|.|.|.|.|.|...|.......|.......|...|.......|.|.....|...|.|.|...|.|...|.....|.|.+-------------------|-|-------+.|.....|.|.....|...............|...|.+-----|---------|-------|-|-----|---|-----|-+.|.
...|.|.|.|.|.|.|.|...|.......|.......|...|.......|.|.....|...|.|.|...|.|...|.....|.|...|.|.....|.........|.|.......|.|.....|.|.....|...............|...|.|.....|...|...|.|.....|.|.|.|.|.|.|.|.....|...|.
...|.|.|.|.|.|.|.|...|.......|.......|...|.......|.|.....|...|.|.|...|.|...|.....|.|...|.|.....|.........|.|.......|.|.....|.|.....|...............|...|.|.....|...|...|.|.....|.|.|.|.|.|.|.|.....|...|.
...|.|.|.|.|.|.|.|...|.......|.......|...|.......|.|.....|...|.|.|...|.|...|.....|.|...|.|.....|.........|.|.......|.|.....|.|.....|...............|...|.|.....|...|...|.|.....|.|.|.|.|.|.|.|.....|...|.
...|.|.|.|.|.|.|.|...|...+---|------------B--------+.+-----------+...|.|...|.....|.|...|.|.....|.........+-|-------+.|.....|.|.....|...............|...|.|.....|...+---|-|---+.|.|.|.|.|.|.|.|.....|...|.
...|.|.|.|.|.|.|.|...|...|...|.......|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.........|.....|.|.....|...............|...|.|.....|.......|.|...|.|.|.|.|.|.|.|.|.....|...|.
...|.|.+-|-|-|---|-------|---|-----------------------|-------|-------|-----|-----|-------|-----|---------------------|-------|---+.|...............|...|.|.....|.......|.|...|.|.|.|.|.|.|.|.|.....|...|.
...|.|...|.|.|.|.|...|...|...|.......|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.........|.....|.|...|.|...............|...|.|.....|.......|.|...|.|.|.|.|.|.|.|.|.....|...|.
...|.|...|.|.|.|.|...|...|...|.......|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.........|.....|.|...|.|.......+-------------|-----|-------|---------|-----------+.....|...|.
...|.|...|.|.|.|.|...|...|...|.......|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.........|.....|.|...|.|.......|.......|...|.|.....|.......|.|...|.|.|.|.|.|.|.|.......|...|.
...|.|...|.|.|.|.|...|...|...|.......|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.........|.....|.|...+-|-------|-------|---|-|-----|-----+.+-+...|.|.|.|.|.|.|.|.......|...|.
...|.|...|.|.|.|.|...|...|...|.......|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.........|.....|.|.....|.......|.......|...|.|.....|.....|.......|.|.|.|.|.|.|.|.......|...|.
...|.|...|.+---|-|---|-------|-----+.|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....+-------+.+-----+.|.......|.......|...|.|.....|.....|.+-----|---+.|.|.|.+-----------+.|.
...|.|...|...|.|.|...|...|...|.....|.|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|...|.|.......|.......|...|.|.....|.....|.|.....|.|...|.|.|...|.......|.|.|.
...|.|.+-|-+.|.|.|...|...|...+-----|-|---|---------------------|-------|---------------|-|-----|---------------------------------+.|.......|.......|...|.|.....|.....|.|...+---------|---+.|.......|.|.|.
...|.|.|.|.|.|.|.|...|...|.........|.|...|.......|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.|.|.|.......|.|.|.
...|.|.|.|.|.|.|.|...|...|.........|.|...|...+-------|---------------|-|---|-------|-----------------------|-----|-------|---------|-------|-----------|-|-----------------|-----------|-+.|.......|.|.|.
...|.|.|.|.|.|.|.|...|...|.........|.|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.|...|.......|.|.|.
...|.|.|.|.|.|.|.|...|...|.........+-|-------|---|-------------------------------|-----|-------------------------|-------|---|-----|---------------------------|-----|-------------|---------------|-+.|.
...|.|.|.|.|.|.|.|...|...|...........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.|...|.......|...|.
...|.|.|.|.|.|.|.|...|...|...........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.+-------+...|...|.
...|.|.|.|.|.|.|.|...|...|...........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.....|...|...|...|.
...|.|.|.|.|.|.|.|...|...|...........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.....|...|...|...|.
...|.|.|.|.|.|.|.|...|...|...........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.....|...|...|...|.
...|.|.|.|.|.|.|.|...|...|...........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.....|...+-----+.|.
...|.|.|.|.|.|.|.|...|...|...........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|.......|...|.|.....|.....|.|...|.|.|...|.|.....|.......|.|.|.
...|.|.|.|.|.|.|.|.+-|-+.|.+---------|---|-------|---|-------|-------|-----|-----|-----|-|-----|-----------------|-------------------------|-------+...|.|.....|.....|.|...|.|.|...|.|.....|.......|.|.|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...|...|...|...|...|.|.....|.|...|.....|.|...|.|.....|...........|.....|...|...|...|.....|.......|...........|.|.....|.....|.|...|.|.|...|.|.....|.......|.|.|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...|...+-------|---|-|-------+...|.....|.|...|.|.....|.........+-|-----|---|-------------|-------------------|-|-----|-----|-----+.|.|...|.|.....|.+-------+.|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...|.......|...|...|.|.....|.....|.....|.|...|.|.....|.........|.|.....|...|...|...|.....|.......|...........|.|.....|.....|.|.....|.|...|.|.....|.|.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...|.......|...|...|.|.....|.....|.....+-|-----------|---------+.|.....|...|...|...|.....|.......|.....+-----|-----+.|.....|.|.....|.|...|.|.....|.|.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...|.......|...|...|.|.....|.....|.......|...|.|.....|...........|.....|...|...|...|.....|.......|.....|.....|.|...|.|.....|.|.....|.|...|.|.....|.|.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...|.....+-|---|---|-------|-----------------|-|-----|-----------|-----|---|---|-----------------+.....|.+---|-----|-|---+.|.|.....|.|...|.|.....|.|.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...|.....|.|...|...|.|.....|.....|.......|...|.|.....|...........|.....|...|...|...|.....|.............|.|...|.|...|.|...|.|.|.....|.|...|.|.....|.|.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|...+-----|-----------|-----------|-------|---|-|-----|---------------------|-------------|---------------------------|---------------|---+.|.....|.|.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.........|...|.........|.|...|...|.|.....|.....|.......|...|.|.....|...........|.....|...|...|...|.....|.............|.|...|.|...|.|...|.|.|.....|.|.....|.....|.|.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.......+-|-+.|.........|.|...|...|.|.....|.....|.......|...|.|.....|...+-------------|-----------|---------------------------|---|-|-+.+-|-|-----|-|---+.|...+-|-+.....|...|.
...|.|.|.|.|.|.|.|.|.|.|.|.|.......|.|.|.|.........|.|...|...|.|.....|.....|.......|...|.|.....|...|.......|.....|...|...|...|.....|.............|.|...|.|...|.|.|...|.|.....|.|...|.|...|.|.......|...|.
...+-|-------+.|.|.|.|.|.|.|.......|.|.|.|.........|.|.+-+...|.|.....|.....|.......|...|.|.....|...|.......|.....|...|...|...|.....|.............|.|...|.|...|.|.|...|.|.....|.|...|.|...|.|.......|...|.
.....|.|.|.|...|.|.|.|.|.|.|.......|.|.|.|.........|.|.|.....|.|.....|.....|.......|...|.|.....|...|.......|.....|...|...|...|.....|.............|.|...|.|...|.|.|...|.|.....|.|...|.|...|.|.......|...|.
.+---|-|-|---------|-|-|-|-|-------------|-------------|-------|-------------------|---|-|-------+.|.......|.....|...|...|...|.....|.............|.|...|.|...|.|.|...|.|.....|.|...|.|...|.|.......|...|.
.|...|.|.|.|...|.|.|.|.|.|.|.......|.|.|.|.........|.|.|.....|.|.....|.....|.......|...|.|.....|.|.|.......|.....|...|...|...|.....|.............|.|...|.|...|.|.|...|.|.....|.|...|.|...|.|.......|...|.
.+-+.|.|.|.|...|.|.|.|.|.|.|.......|.|.|.|.........|.+---+.+-|-|-----|-----------------|-----------------------------|-------|-----|-------------------|---------|-+.|.|.....|.|...|.|...|.|.......|...|.
...|.|.|.|.|...|.|.|.|.|.|.|.......|.|.|.|.........|...|.|.|.|.|.....|.....|.......|...|.|.....|.|.|.......|.....|...|...|...|.....|.............|.|...|.|...|.|.|.|.|.|.....|.|...|.|...|.|.......|...|.
.+-|---|---|-----|-|---|-------------|-----------------|-|-+.|.|.....|.....|.......|...|.|.....|.|.|.......|.....|...|...|...|.....|.............|.+-----+.+-----|-+.+-|-------------|---|-+.......|...|.
.|.|.|.|.|.|...|.|.|.|.|.|.|.......|.|.|.|.........|...|.|...|.|.....|.....|.......|...|.|.....|.|.|.......|.....|...|...|...|.....|.............|.....|...|.|.|.|.....|.....|.|...|.|...|.........|...|.
.|.|.|.|.|.|...|.|.|.|.|.|.|...+-----|-----+.......|...|.|...+-------|-------------------|-----------------------|---|---|---|-----|-------------|-----+...+-+.|.|.....|.....|.|...|.|...|.........|...|.
.|.|.|.|.|.|...|.|.|.|.|.|.|...|...|.|.|.|.|.......|...|.|.....|.....|.....|.......|...|.|.....|.|.|.......|.....|...|...|...|.....|.............|.............|.|.....|.....|.|...|.|...|.........|...|.
.|.|.|.|.|.|.+-|-|-|-|-|-|-|M--+...|.|.|.|.+-------+...|.|...+-------|-----|-------|-----------|---------------------|---|---|-----------------------------------------|-----|-----------|-----+...|...|.
.|.|.|.|.|.|.|.|.|.|.|.|.|.|.......|.|.|.|.............|.|...|.|.....|.....|.......|...|.|.....|.|.|.......|.....|...|...|...|.....|.............|.............|.|.....|.....|.|...|.|...|.....|...|...|.
.|.|.|.|.|.|.|.|.|.|.|.|.|.|.....+-|-|-|-|-------------|-----|-------------|-------|---|-|---------|-------|-----|---------------------------------+...........|.|.....|.....|.|...|.|...|.....|...|...|.
.|.|.|.|.|.|.|.|.|.|.|.|.|.|.....|.|.|.|.|.............|.|...|.|.....|.....|.......|...|.|.....|.|.|.......|.....|...|...|...|.....|.............|.|...........|.|.....|.....|.|...|.|...|.....|...|...|.
.|.+-----|-|-----|-|-|---|-|-----|-------|-+...+---------+...+-|-----------|-------------------|-+.|.......|.....|...|...|...|.....|.............|.|...........|.|.....|.....|.+---|-----------|---+...|.
.|...|.|.|.|.|.|.|.|.|.|.|.|.....|.|.|.|.|.|...|.......|.......|.....|.....|.......|...|.|.....|...|.......|.....|...|...|...|.....|.............|.|...........|.|.....|.....|.....|.|...|.....|.......|.
.|...|.|.|.|.|.|.|.|.|.|.|.|.....|.|.|.|.+-|---|---------------------------|-----------|-----------|-------|-----|---|---|-------------------------------------|-------|---------------+.|.....|.......|.
.|...|.|.|.|.|.|.|.|.|.|.|.|.....|.|.|.|...|...|.......|.......|.....|.....|.......|...|.|.....|...|.......|.....|...|...|...|.....|.............|.|...........|.|.....|.....|.....|.|.|.|.....|.......|.
.|...|.|.|.|.|.|.|.|.|.|.|.|.....|.|.|.|...|...|.......|.+-----|-----|-----|-----------|-|-----------------|-----+...|...+---|-----|-------------|-|-------------|---------------------|---+.+---+.....|.
.|...|.|.|.|.|.|.|.|.|.|.|.|.....|.|.|.|...|...|.......|.|.....|.....|.....|.......|...|.|.....|...|.......|.........|.......|.....|.............|.|...........|.|.....|.....|.....|.|.|.|.|.|.|.|.....|.
.|...|.+-|---+.|.|.|.|.|.|.|.....|.|.+-|-------------+.+-|-----|-----+.....|.......|...|.|.....|...+-------------------------|---------------------|-----------|-|-----|-----------|---|-|---|-|-|-+...|.
.|...|...|.|...|.|.|.|.|.|.|.....|.|...|...|...|.....|...|.....|...........|.......|...|.|.....|...........|.........|.......|.....|.............|.|...........|.|.....|.....|.....|.|.|.|.|.|.|.|.|...|.
.|...|...|.|...|.|.|.|.|.|.|.....|.|...|...|...|.....|...|.....|...........|.......|...|.|.....|...........|.........|.......|.....|.............|.|...........|.|.....|.....|.....|.|.|.|.|.+-|---|-+.|.
.|...|...|.|...|.|.|.|.|.|.|.....|.|...|...|...|.....|...|.....|...........|.......|...|.|.....|...........|.........|.......|.....|.............|.|...........|.|.....|.....|.....|.|.|.|.|...|.|.|.|.|.
.|...+-+.|.|...|.|.|.|.|.|.|.+---|-|-----------------|---------------------|-----------|-|---+.|...........|.........|.......|.....|.............|.|...........|.|.....|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.E.|...|.|.|.|.|.|.|.|...|.|...|...|...|.....|...|.....|...........|.......|...|.|...|.|...........|.........|.......|.....|.............|.|...........|.|.....|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.|.+-------|-|-|---|-----|---+.|...|...|.....|...|.....|...........|.......|...|.|...|.|...........+-----------------|-----------------------+.........|.|.....|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.|.....|.|.|.|.|.|.|.|...|.|.|.|...|...|.....|...|.....|...........|.......|...|.|...|.|.....................|.......|.....|.............|.|.|.........|.|.....|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.|.+---------------+.|...|.|.|.|...|...|.....+-------+.|...........|.......|...|.|...|.|.+-------------------|-------------+.............|.|.|.........|.+---+.|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.|.|...|.|.C.|.|.|...|...|.|.|.|...|...|.........|...|.|...........|.......|...|.|...|.|.|...................|.......|...................|.|.|.........|.....|.|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.|.|...|.|.|.|.|.|...|...|.|.|.|...|...|.+-----------|-------------------------|-----+.|.|...................|.......|...................|.|.|.........|.....|.|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.|.|...|.|.|.|.|.|...|...|.|.|.|...|...|.|.......|...|.|...........|.......|...|.|.....|.|...................|.......|...................|.|.|.........|.....|.|.....|.....|.|.|.|.|...|.|.|.|.|.
.|.....|.|.|...|.|.|.|.|.|...|...|.|.|.|...|...|.|.......|...|.|...........|.......|...+-------|-----------------------------|-------------------|---|-----+...|.....|.|.....|.....+-|-|-|---+.|.|.|.|.|.
.|.....|.|.|...|.D.|.|.|.|...|...|.|.|.|...|...|.|.......|...|.|...........|.......|.....|.....|.|...................|.......|...................|.|.|.....|...|.....|.|.....|.......|.|.|.|.|.|.|.|.|.|.
.|.....|.|.|...|.|.|.|.|.|...|...|.+-+.|...|.+-+.|.......|...|.|...........|.......|.....|.....|.|...................|.......|...................|.|.|.....|...|.....|.|.....|.......|.|.|.|.|.|.|.|.|.|.
.|.....|.|.|...|.|.|.|.|.|...|...|.....|...|.|...|.......|...|.|...........|.......|.....|.....|.|...................|.......|...................|.|.|.....|...|.....|.|.....|.......|.|.|.|.|.|.|.|.|.|.
.|.....|.|.|...|.|.|.|.|.|...|...|.....|...|.|.+---+.+-------|-------------|-------------|---------------------------|-------------------------------+.....+---|-------|-----|-------|-------+.|.|.|.|.|.
.|.....|.|.|...|.|.|.|.|.|...|...|.....|...|.|.|.|.|.|...|...|.|...........|.......|.....|.....|.|...................|.......|...................|.|...........|.....|.|.....|.......|.|.|.|...|.|.|.|.|.
.|.....|.+-----|-----+.|.|...|...|.....|...|.|.|.|.|.|.+-|---|---------------------------------|-----------------------------+...................|.|...........|.....|.|.....|.......|.+-----+.|.|.|.|.|.
.|.....|...|...|.|.|...|.|...|...|.....|...|.|.|.|.|.|.|.|...|.|...........|.......|.....|.....|.|...................|...........................|.|...........|.....|.|.....|.......|...|.|.|.|.|.|.|.|.
.|.....|...|.+---------|-|---|---|---+.|...|.|.|.|.|.|.|.|...|.|...........|.......|.....|.....+-------------------------------------------------|-|---+.......|.....|.|.....|.......|...|.|.|.|.|.|.|.|.
.|.....|...|.|.|.|.|...|.|...|...|...|.|...|.|.|.|.|.|.|.|...|.|...........|.......|.....|.......|...................|...........................|.|...|.......|.....|.|.....|.......|...|.|.|.|.|.|.|.|.
.|.....|...|.|.|.|.|...|.|...|...|...|.|...|.|.|.|.|.|.|.|...|.|...........|.......|.....|.......|...................|...........................|.|...|.......|.....|.|.....|.......|...|.|.|.|.|.|.|.|.
.|.....|...|.|.|.|.|...|.|...|...|...|.|...|.|.|.|.|.|.|.|...|.|...........|.......|.....|.......|...................|...........................|.|...|.......|.....|.|.....|.......|...|.|.|.|.|.|.|.|.
.|.....|...|.+-----|-------------|---|-|-----------|-|-------|-|-----------|-------|-----|---------------------------|---------------------------|-|---|-------|-------------|-----+.|.+-+.|.|.|.|.|.|.|.
.|.....|...|...|.|.|...|.|...|...|...|.|...|.|.|.|.|.|.|.|...|.|...........|.......|.....|.......|...................|...........................|.|...|.......|.....|.|.....|.....|.|.|...|.|.|.|.|.|.|.
.|.....|...+-------|-----|---|---|-----|-----|---------|-------|---------------+...+-----|-------|-+.................|...........................|.|...|.......|.....+-------------|-|---+.|.|.|.|.|.|.|.
.|.....|.......|.|.|...|.|...|...|...|.|...|.|.|.|.|.|.|.|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|.....|.|.|.|.|.|.|.|.|.|.|.
.|.....|.......|.|.|...+---------|---|-----|---|-|-|-|-------|-|---------------|---------|-------|-|-----------------|-------------------------+.|.|...|.......|.......|.....|.....+-|-+.|.+-|---+.|.|.|.
.|.....|.......|.|.|.....|...|...|...|.|...|.|.|.|.|.|.|.|...|.|...........|...|.........|.......|.|.................|.........................|.|.|...|.......|.......|.....|.......|...|...|.|...|.|.|.
.|.....|.......+-|-|---+.|...|...|...|.|...|.|.+-|-|-|---------|-----------|-------------|-----------------------------------------------------+.|.|...|.......|.......|.....|.......|...|...|.|.+---+.|.
.|.....|.........|.|...|.|...|...|...|.|...|.|...|.|.|.|.|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|.......|...|...|.|.|.|...|.
.|.....|.....+---|-|-----|-------------|-----|---|-----+.|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|.......|...|...|.|.|.|...|.
.|.....|.....|...|.|...|.|...|...|...|.|...|.|...|.|.|...|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|.......|...|...|.|.|.|...|.
.+-----|-----------------|-------|---+.+-------+.+-|-----|-----------------|---------------------|-|---------------------------------------------|-|---|-------|-------|-----|---+...|...|...|.|.|.|...|.
.......|.....|...|.|...|.|...|...|.........|.|.|...|.|...|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|...|...|...|...|.|.|.|...|.
.......|.....|...|.|...|.|...|...+-----------|-------|-------|-|-------------------------|-------|-|-----------------|---------------------------|-----|-------|-------|---------|---|---------|-|-+...|.
.......|.....|...|.|...|.|...|.............|.|.|...|.|...|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|...|...|...|...|.|.|.....|.
.......|.....|...|.|...|.|...|.............|.|.|...|.|...|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|...|...|...|...|.+-----+.|.
.......|.....|...|.|...|.|...|.............|.|.|...|.|...|...|.|...........|...|.........|.......|.|.................|...........................|.|...|.......|.......|.....|...|...|...|...|...|...|.|.
.......|.....|...|.|...|.|...|.............|.|.|...|.|...|...|.|...........|...|.........|.......|.|.................|.........................+-+.|...|.......|.......|.....|...|...|...|...|...|...|.|.
.......|.....|...|.|...|.|...|.............|.|.|...|.|...|...|.|...........|...|.........|.......|.|.................|.........................|...|...|.......|.......|.....|...|...|...|...|...|...|.|.
.......|.....|...|.|...|.|...|...+---------|-|-----------|---+.+-----------|---|---------+.......+-----------------------------------------------------|---------------------------------|---|-------+.|.
.......|.....|...|.|...|.|...|...|.........|.|.|...|.|...|.................|...|...................|.................|.........................|...|...|.......|.......|.....|...|...|...|...|...|.....|.
.......|.....|...|.|...|.|...|...+-------------|-+.+-----+.+-------------------+...................|...........+-----|-+.......................|...|...|.......|.......|.....|...|...|...|...|...|.....|.
.......|.....|...|.|...|.|...|.............|.|.|.|...|.....|...............|.......................|...........|.....|.|.......................|...|...|.......|.......|.....|...|...|...|...|...|.....|.
.......|.....|...|.|...+-----------------------------|---------------------------------------------|-----------|-----------------------------------|-----------+.......|.....|...|...|...|...|...|.....|.
.......|.....|...|.|.....|...|.............|.|.|.|...|.....|...............|.......................|...........|.....|.|.......................|...|...|...............|.....|...|...|...|...|...|.....|.
.......|.....|...|.|.....|...|.....+-------|-|-|-----------+...............+-----------------------------------|-----+.|.......................|...|...+-+.............|.....|...|...|...|...|...|.....|.
.......|.....|...|.|.....|...|.....|.......|.|.|.|...|.............................................|...........|.......|.......................|...|.....|.............|.....|...|...|...|...|...|.....|.
.......+-----|---+.|.....|...+-------------|-------------------------------------------------------+...........|.......|.......+---------------|---|-----|-------------|-----|---------------|---------+.
.............|.....|.....|.........|.......|.|.|.|...|.........................................................|.......|.......|...............|...|.....|.............|.....|...|...|...|...|...|.......
.............+---------------------|-------|---|-----|-----------------------------------------------------------------|-------+...............|...|.....+-------------+.....|...|.+-|---+...|...|.......
...................|.....|.........|.......|.|.|.|...|.........................................................|.......|.......................|...|.........................|...|.|.|.......|...|.......
.......+---+.......|...+-|---------+.......+-|---|---+.........................................................|.......+---------------------------+.........................|...|.|.|.......|...|.......
.......|...|.......|...|.|...................|.|.|.............................................................|...............................|.............................|...|.|.|.......|...|.......
.......|...|.......+---|-|-------------------|---------------+.................................................|.......................+-------|-----------------------------|---|---|-------|---+.......
.......|...|...........|.|...................|.|.|...........|.................................................|.......................|.......|.............................|...|.|.|.......|...........
.......+---------------+.|...................+-+.+-----------+.................................................|.......................+-------+.............................|...|.|.|.......|...........
...........|.............|.....................................................................................|.............................................................|...|.|.|.......|...........
...........+-----------+.+-------------------------------------------------------------------------------------+.......................................................+-----+...+-|-+.......|...........
.......................|...............................................................................................................................................|...........|.........|...........
.......................+-----------------------------------------------------------------------------------------------------------------------------------------------+...........+---------+...........
.........................................................................................................................................................................................................
`

const input3 = `
`;


function parseInput(input) {
    return input.trim().split('\n').map(line => {
        return line.trim().split('');
    })
}

function directionToVector(dir) {
    if (dir == 0) return {delX: 0, delY: 1};
    if (dir == 1) return {delX: -1, delY: 0};
    if (dir == 2) return {delX: 0, delY: -1};
    if (dir == 3) return {delX: 1, delY: 0};
}

function insideBounds(row, col, input) {
    return !(row < 0 || row >= input.length ||
             col < 0 || col >= input[0].length)
}

function main1() {
    const input = parseInput(input2);

    // Find entry
    let currentRow = 0;
    let currentColumn = 0;
    for (let i = 0; i < input[0].length; i++) {
        if (input[0][i] === '|') {
            currentColumn = i;
            break;
        }
    }

    let foundLetters = [];
    let foundEnd = false;
    let currentDirection = 0;
    let countSteps = 0;
    while (!foundEnd) {
        // Find next path
        const { delX, delY } = directionToVector(currentDirection);
        const nextRow = currentRow + delY;
        const nextColumn = currentColumn + delX;
        if (insideBounds(nextRow, nextColumn, input) && input[nextRow][nextColumn] == '.')
        {
            foundEnd = true;
            countSteps++;
            break;
        }

        const nextElement = input[nextRow][nextColumn];
        if (nextElement == '|' || nextElement == '-') {
            // Do nothing special
        } else if (nextElement == '+') {
            // Find new direction
            for (let dir = 0; dir < 4; dir++) {
                if (dir == currentDirection) continue;
                const { delX, delY } = directionToVector(dir);
                const next2Row = nextRow + delY;
                const next2Column = nextColumn + delX;
                if (!insideBounds(next2Row, next2Column, input)) continue;
                const next2Element = input[next2Row][next2Column];
                if (next2Element != '.' && next2Column != currentColumn && next2Row != currentRow) {
                    currentDirection = dir;
                    break;
                }
            }
        } else {
            foundLetters.push(nextElement);
        }

        countSteps++;

        currentColumn = nextColumn;
        currentRow = nextRow;
    }

    console.log(foundLetters);
    console.log(foundLetters.join(''));
    console.log(countSteps);
}


function main2() {
    // Already in main1, only countSteps added.
}

main1();